# Github Blog

- 원래는 지킬과 같은 플랫폼을 먼저 만든 후, 깃허브 블로그를 만드려고 했었다. 그러나 React나 Bootstrap등을 공부해본 바, 그러한 라이브러리를 이용하면서 플랫폼까지 만드는 것은 상당히 어렵고 귀찮다는 것을 알게 되었다.
- 그래서 그냥 깃허브 블로그만을 만들려고 한다.
- 그렇다면, 스킨 관련된 기능은 전부 제거하고, 포스트 관련 기능만 구현하면 된다.

## 2020 / 07 / 12

### Serverside 구성

- 기본적으로 React app으로 하고, SPA로 만들어보자.
- 개발을 위해서는, 그냥 기본으로 제공하는 start 스크립트를 사용한다.
- Browser routing을 구현하기 위해 `react-router-dom`을 사용한다.
- 디자인으로는 `react-bootstrap`을 사용한다. 추후 업데이트하던가 하자.

### 구현 방법

여기서도 막히는 것이, 어떻게 포스트와 그 목록을 적절히 구현하는가 하는 것이다.

- 일단 이전에 작성해놓은 스크립트를 사용하면 포스트의 목록을 다 가져올 수 있기는 하다.
- Browser routing을 하면, 심지어 적절한 HTML파일을 가져올 수도 있다.
  - 거의 다 왔는데...
- 그렇다면 라우터에서 posts라우터를 작성한다. 그리고 `post/:postID` 방식으로 포스트 파일 이름을 가져온다. 그리고 `postID.js`(혹은 jsx)파일을 require하여 렌더링한다.
- 물론, 이렇게 하면 아무 글을 읽을 때마다 모든 포스트를 로드하는 무서운 일이 벌어진다. 그러므로 React의 code splitting 기법을 사용하여 포스트를 로드하기로 한다.
  - Code splitting 기능을 사용하여
- 이렇게 하면, 최소한의 low-level코드만을 사용하고, 나머지는 IDE에서 깔끔하게 처리할 수 있다.
- 포스트 목록 등은 json파일로 구현될 텐데, 이 json파일을 어떻게 로드하는가도 하나의 문제다.
- 검색해본 바, `create-react-app`을 사용한 경우 `json-loader`가 포함되어있다고 한다. 그러므로 이를 사용해본다.
  - `json-loader`가 잘 작동하는 것을 확인했다.
- 이게 된다면, 거의 다 온 거다. 조금만 더 가면 된다.

## 2020 / 07 /13

### 상세

블로그를 만드려면 포스트나 여러 정보들을 불러와야 한다. 이걸 어떻게 구현할까?

#### 포스트 메타데이터

- 가장 먼저, 포스트의 목록이나 태그의 목록은 걱정할 일이 아니다. 왜냐하면 단순히 import를 해서 사용하면 되기 때문이다.
- 태그별 포스트도 딱히 분리할 필요가 없을 것 같다. 조사해본 바, 포스트 하나당 많아 봐야 500byte정도가 요구된다. 즉, 포스트를 매우 많이 올려서 1000개를 작성한다고 해도 500kbyte인데, 이정도가 되어야 고화질 이미지 한 장 분량이다.
  - 만약 블로그가 점점 커져서 감당할 수 없게 되면, 그때쯤에야 태그별 포스트를 구분하는 게 좋겠다.
- 그러므로 이미 만들어놓은 포스트 메타데이터 시스템은 그대로 이식하기로 한다

#### 포스트 렌더링

- 이건, Browser router에서 `posts/:postID` 형식의 path로 접근할 경우, `postID`에 해당하는 포스트를 렌더링하는 것으로 족하다. 그러려면 일단 포스트에 해당하는, import가능한 파일이 있어야 한다. 이는 md파일을 번역한 jsx파일이면 족하다.
- 그런데, 포스트 시스템에서 replace를 어떻게 구현할지가 문제다. 템플릿을 어떻게 구현하면 좋지?
  - 일단은 그냥 jsx파일을 생성하고, metadata도 가져오는 거로 해버리는 편이 제일 낫겠다.
- 위에서 언급한 모든 내용들을 간단히 구현하는 데에 성공했다. 신난다! 비동기 포스트 로드 및 코드 스플리팅을 동시에 구현해야 했는데, 이렇게 부드럽게 잘 될 줄은 몰랐다. 이제야 react의 사용 방법을 약간 알게 된 느낌이다.
  - 생각해보니 비동기 포스트 로드 및 코드 스플리팅은 적어도 React에서는 같은 말이었다. 비동기를 하게 되면 저절로 코드 스플리팅이 이뤄진다. 물론, `import(lib)`을 사용하지 않고 잘못 비동기 로드를 하면 코드상으로는 비동기로 보이지만 bundling하면 같은 js파일로 묶일 수도 있기는 하다.

이제는

1. 블로그에 글을 작성한 후
2. `src/blog.js`파일을 실행시키면 메타데이터와 jsx파일이 생성되고
3. `yarn build`로 빌드하면 블로그가 빌드된다.
4. build path에서 git push하여 원격 리포지토리에 올리는 것까지 하면 완료다.

이걸 어떻게 자동화를 잘 할 수 있을 것 같은데...

#### 디자인

이제 디자인을 어떻게 할 것인가가 문제다.

- 나는 넓고 깨끗한 화면이 좋으니까, 타이틀을 크게 넣자. 타이틀에는 `{ UnknownPgr }` 이정도 박아두면 좋겠다.
- 우측 상단에 깃허브 링크를 박아두는 것도 나쁘지 않다.
- 그리고 게시글은 깔끔하게 사각형으로 해야겠다. 최소 간격은 마진으로 주고, 레이아웃은 flex로 하는 게 좋겠다.

## 2020 / 07 / 14

### 사이드바 구현

- 이제 포스트 리스트를 깔끔하게 구현하였으니, 사이드바를 어떻게 구현할지가 문제다.
- 사이드바에는 깔끔하게 포스트 카테고리 목록만을 넣을 예정이다.
- 여러가지 시도를 해 봤다. `Nav`를 사용할까도 생각해보고...그런데 어떻게 하더라도 보기 좋은 디자인을 만들기가 어려웠다. 그래서 그냥 기본 리스트 `<ul><li></li></ul>`를 사용하기로 했다. 물론 내가 원하는 예쁜 디자인은 아니기는 한데, 마음에 안 든다 싶으면 나중에 개조하면 될 일이다.
- 사이드바를 구현했으니 이제는 사이드바를 누르면 나타날 카테고리별 포스트 목록을 구현해야 한다.
  - 이것을 따로 구현하는 건 UI재사용성을 극대화한 React와는 좀 맞지 않는 것 같아서, 그냥 메인 포스트 화면의 리스트를 가져다 쓰기로 했다.
  - 메인 포스트 리스트에 `filter`속성을 추가해서, `filter`가 없으면 모든 포스트를 보여주고, `filte`가 있을 경우 `filter===category`인 포스트만 보여주도록 설정했다.

### UI

- 또 어려웠던 부분 중 하나는, title과 footer 사이에서 main container가 빈 공간을 채우도록 만드는 것이었다.
  - `root`에 `flex` 속성을 주고, title과 footer 사이즈를 고정한 후에 main container에 `flex:1`을 주어 해결했다.
- 그리고 왜인지 모르겠지만, `html`에 `height : 100%`를 주고, `body`에 `min-height : 100%`를 주니 `body`가 내부 사이즈에 맞게 줄어들어버렸다.
  - `body`에 `min-height : 100%`대신 `min-height : 100vh`를 주어 해결했다.

### React

- 위에서 사이드바에서 버튼을 누르면 해당 카테고리가 볼드체가 되도록 하고 싶었다.
  - 그래서 최상위에 `useState`를 통해서 컨텍스트를 생성하고, 카테고리별 포스트 리스트 페이지의 render함수에서 `setCurrentCategory`를 호출하여 업데이트하려고 했다. 그런데 `category~~`를 렌더링하는 중 `App`을 렌더링할 수 없다고 경고가 떴다.
  - 하위 엘리먼트의 `render` 함수에서 상위 엘리먼트를 업데이트하면 안 된다는걸 알게 됐다.
  - 리액트의 컨텍스트에 대해 더 잘 알게 된 느낌이다.
