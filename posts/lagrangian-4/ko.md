---
title: 라그랑주 역학[4] - 특수한 시스템
tags:
  - math
  - science
date: 2020-11-02T04:44:48.256Z
---

# 특수한 시스템

원래는 3편에서 글을 마무리하려고 했는데, 생각해보니 안 다룬 것이 있었습니다. 바로 시스템이 라그랑주 역학으로 쉽게 다룰 수 없는 경우입니다. 우리가 저번까지 다뤘던 시스템들은 전부 미분가능한 시스템이었습니다. 그러나 실제로는 시스템이 미분 불가능한 경우가 훨씬 많습니다. 이런 경우에는 어떻게 하면 좋을까요?

## 불연속적인 시스템

가장 대표적인 예는 불연속적인 시스템입니다. 예를 들어, 가장 간단한 경우로 공이 벽에 부딛혀 튕겨나오는 충돌을 생각해보면 그 경로에는 충돌 시 첨점이 생기므로 미분불가능한 경로가 됩니다.

## 범위가 주어진 시스템

다른 경우로, 시스템의 범위가 주어진 경우가 있습니다. 예를 들어, 이전 포스트에서 다루었던 진자는 각도가 자유롭습니다. 그래서 진자가 고정된 그 점보다 높은 좌표로도 올라갈 수 있습니다. 그러나 예를 들어, 진자가 움직일 수 있는 각도에 제한을 두어서 진자가 특정 각도 이내에서만 진동하기를 원할 수도 있습니다. 대표적으로 천장에 줄을 달아 놓은 경우, 진자가 천장을 뚫지 않는 한 -90도에서 90도까지만 진동할 수 있습니다.

## 구속력이 한 방향인 시스템

마지막으로 구속이 단방향인 경우도 있습니다. 커다란 반구 꼭대기에서 작은 구를 굴러 미끄러트립니다. 그럴 경우 이 작은 구는 처음에는 큰 구의 표면을 따라서 구르다가, 어느정도 경사가 가팔라지면 그때부터는 구면을 벗어납니다.

# 해결 방법

위 단락에서는 이해를 돕고자 여러 예시를 들어 놨지만, 실은 모두 한 가지로 설명할 수 있습니다. 바로 시스템이 불연속적인 퍼텐셜을 가지는 경우입니다. 예를 들어 공이 바닥에서 튀는 경우를 생각해봅시다. 이 경우 공은 공중에서는 중력에 의한 ($mgh$로 표현되는) 퍼텐셜을 가집니다. 그러나 공이 바닥보다 아래에 있는 경우에는 이론상 무한대의 퍼텐셜을 가지게 되므로, $h=0$에서 퍼텐셜이 불연속적인데다 발산하게 됩니다.

이런 경우를 해결하기 위해서는 크게 두 가지 방법이 있습니다.

## 연속적인 척 하기

첫 번째는 그냥 시스템이 연속적인 척 하는 것입니다. 예를 들어 공이 바닥에 튕기는 경우, 공이 크기가 없는 입자이고 바닥이 강체일 경우 $h=0$에서 시스템이 불연속입니다. 그러나 현실을 약간 반영해서 바닥이 강체가 아니라 탄성계수가 매우 큰 탄성체라고 가정하면, $h=0$에서 시스템이 빠르게 증가하기는 하나 불연속은 아닙니다. 그러므로 다음과 같이 퍼텐셜을 줄 수 있습니다.

$$
U=mgh+e^{-\beta h}
$$

이때 $\beta$는 적당히 큰 값으로 줍니다. 경험상 4~6정도면 나쁘지 않았습니다. 이렇게 하면 $h>0$에서는 거의 $mgh$가 되고, $h<0$에서는 빠르게 발산하므로 우리가 원하는 퍼텐셜을 만들 수 있습니다.

그리고 0에서 빠르게 증가하는 함수는 $\beta/h^2$등 여러 함수가 있으므로 적당한 함수를 가져다 써도 아무런 문제가 없습니다. 제가 $e^{\beta h}$라는 함수를 선택한 이유는 제가 인터넷에서 본 [레퍼런스](https://www.slideserve.com/donar/nano-mechanics-and-materials-theory-multiscale-methods-and-applications-powerpoint-ppt-presentation)에서 이 함수를 사용했기 때문입니다. 그 레퍼런스에서 이 함수를 쓴 이유는 아마도

1. 함수가 미분하기 쉬운데다
2. Floating point error등에 영향을 적게 받고
3. 오차에 좀 덜 민감해서

가 아닌가 싶습니다. 예를 들어 $1/h^2$이라는 함수를 썼다면, 수치해석을 통해 시뮬레이션을 하다 오차로 인해 $h<0$이 되는 순간 바닥을 뚫고 아래쪽으로 떨어질 것입니다. 아래는 이 방법을 사용하여 2차원 퍼텐셜 우물을 구현한 예제입니다.

<iframe src="https://unknownpgr.github.io/lagrangian-mechanics/sim-bounce.html"></iframe>

## 일반화 힘을 사용하여 분석하기

다른 방법은 일반화 힘을 사용하는 것입니다. 그런데 일반화 힘을 사용한 분석 방법은 이것만으로도 포스팅 하나를 쓸 수 있을 만큼 분량이 깁니다. 때마침 ~~나무위키~~(...)에 그 내용이 상세하게 잘 나와있습니다. 그래서 나무위키의 [구속력이 있는 경우의 오일러-라그랑주 방정식 풀이](https://namu.wiki/w/%EB%9D%BC%EA%B7%B8%EB%9E%91%EC%A3%BC%20%EC%97%AD%ED%95%99#s-5.2) 단락을 참조하시면 좋을 것 같습니다.
