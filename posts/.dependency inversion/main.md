---
title: From dependency inversion to Spring
category: Development
---

# 의존성 역전에서 스프링 프레임워크까지

이번에 '클린 아키텍처' 책을 읽었습니다. 그러면서 의존성 역전이 왜 중요하고, 어떤 목적을 가지는지 깨닫게 됐습니다. 그래서 이번 포스트에서는 이를 간단히 정리해두려고 합니다.

## 의존성 역전이란?

의존성 역전은 소프트웨어 설계 원칙 중 하나이며, 다음과 같이 정의됩니다.

> 상위 수준의 컴포넌트는 하위 수준의 컴포넌트에 의존하면 안된다.

이때 상위 수준의 컴포넌트라 하면 순수 논리, 비즈니스 모델에 가까운 컴포넌트를 말하며 하위 수준의 컴포넌트란 구체적인 기술, 예컨대 데이터베이스, 파일 시스템, 웹 서버 등을 말합니다. 의존이란 말 그대로 코드 상에서 그 컴포넌트를 참조하는 것을 말합니다.

이것이 '의존성 역전'이라 불리는 이유는, 보통 상위 컴포넌트가 하위 컴포넌트를 사용하므로 _제어 흐름은 상위 컴포넌트에서 하위 컴포넌트로 향하는 반면_ 의존성은 반대로 하위 컴포넌트에서 상위 컴포넌트로 향하기 때문입니다.

여기서 중요한 것은 '제어 흐름'과 '의존성' 이 서로 같은 방향을 가리키는 것이 자연스럽지만, 오히려 의존성이 제어 흐름과 반대로 되어야 한다는 것입니다.

## 의존성 역전의 목적

의존성 역전이 필요한 가장 중요한 이유는 코드의 유지보수성을 높이기 위함입니다. 나중에 설명하겠지만, 의존성 역전을 구현하지 않으면 오히려 코드의 생산성은 올라갑니다. 그래서 작은 규모의 프로젝트에서 의존성 역전을 철저히 지키기란 어렵습니다.

의존성 역전이 코드의 유지보수성을 높이는 이유는 간단합니다. 변경이 쉬운 컴포넌트에 변경하기 어려운 컴포넌트가 의존하는 경우, 변경하기 쉬운 컴포넌트의 수정이 어려운 컴포넌트의 수정을 수반하므로 대단히 작업량이 많아지기 때문입니다. 특히 어떤 컴포넌트가 변경이 어려운 이유는 보통 다른 많은 컴포넌트들이 거기에 의존하기 때문입니다. 그렇기 때문에 작은 업데이트를 위해 코드베이스 전체를 수정하게 될 수도 있습니다.

예를 들어 어떤 시스템에서 유저에게 알림을 보내는 것이 대단히 중심적이고 이곳저곳에서 자주 사용되는 기능이라고 가정해보겠습니다. 이 시스템은 문자 메시지를 사용하므로 SmsSender라는 클래스를 만들어 기능을 구현했습니다. 이 기능은 수백 군데에서 사용되었습니다.

그런데 갑자기 회사 대표가 알림 시스템에 메일을 추가하기로 결정했습니다.

> 개발자: 어...

이 경우 '알림 보내기' 라는 변경이 어렵고 중심적인 기능이 '문자 메시지 보내기' 라는 변경하기 쉬운 기능에 의존하였으므로 이러한 문제가 발생합니다. 만약 알림 보내기 기능은 문자 메시지와 완전히 독립적으로 존재하고, 반대로 문자 메시지를 보내는 기능이 알림 기능에 의존하였다면 이메일을 보내는 가능을 추가하거나, 문자 메시지를 보내는 기능을 이메일까지 함께 보내도록 업데이트만 하면 되었을 것입니다.

## 의존성 역전의 구현

의존성 역전을 구현하는 다양한 방법이 있습니다. 그러나 가장 일반적인 방법은 인터페이스 사용하는 것입니다.

위 예시의 경우, 비즈니스 로직을 담당하는 컴포넌트에서 SmsSender를 참조하고 있습니다. 그러므로 제어 흐름과 의존성이 같은 방향을 향합니다. 그러나 의존성 역전을 적용하면 오히려 SmsSender에서 메인 컴포넌트를 참조해야 합니다.

이를 위해서 메인 컴포넌트에 AlertSender라는 인터페이스, 혹은 추상 클래스를 추가합니다. 그리고 알림을 보내는 로직에서는 AlertSender를 사용하여 알림을 보냅니다. 그리고 SmsSender가 AlertSender를 상속하도록 만듭니다. 이렇게 하면
